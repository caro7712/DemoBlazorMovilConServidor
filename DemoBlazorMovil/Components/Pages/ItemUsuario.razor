@using DemoBlazorMovil.Shared.Models
@inject HttpClient Http
@inject NavigationManager NavigationManager

@if (Usuario != null)
{
    <div class="card my-3 shadow-sm">
        <div class="card-header d-flex justify-content-between align-items-center">
            <h5>@Usuario.Name (@Usuario.Rol)</h5>
            <div>
                <button class="btn btn-sm btn-primary me-2" @onclick="Editar">Editar</button>
                <button class="btn btn-sm btn-danger" @onclick="Borrar">Borrar</button>
            </div>
        </div>
        <div class="card-body">
            <p><strong>Domicilio:</strong> @Usuario.Domicilio</p>
            <p><strong>Correo:</strong> @Usuario.Correo</p>
            <p><strong>Contraseña:</strong> @Usuario.Contraseña</p>
            @if (!string.IsNullOrEmpty(Usuario.Imagen))
            {
                <img src="@Usuario.Imagen" alt="Foto de @Usuario.Name" class="img-thumbnail" style="max-width: 150px;" />
            }
        </div>
    </div>
}
else
{
    <p>Cargando usuario...</p>
}

@code {
    [Parameter]
    public UsuarioDTO Usuario { get; set; }

    [Parameter]
    public EventCallback OnDeleted { get; set; }

    private void Editar()
    {
        NavigationManager.NavigateTo($"/FormUsuario/{Usuario.Id}");
    }

    private async Task Borrar()
    {
        var response = await Http.DeleteAsync($"usuario/{Usuario.Id}");
        if (response.IsSuccessStatusCode && OnDeleted.HasDelegate)
        {
            await OnDeleted.InvokeAsync();
        }
    }
}
