@using DemoBlazorMovil.Shared.Models
@inject HttpClient Http
@inject NavigationManager NavigationManager

<div class="card my-3">
    <div class="card-header d-flex justify-content-between align-items-center">
        <h5>@Producto.Name</h5>
        <div>
            <button class="btn btn-sm btn-primary me-2" @onclick="Editar">Editar</button>
            <button class="btn btn-sm btn-danger" @onclick="Borrar">Borrar</button>
        </div>
    </div>
    <div class="card-body">
        <p><strong>Precio:</strong> @Producto.Precio</p>
        <p><strong>Stock:</strong> @Producto.Stock</p>
        @if (!string.IsNullOrEmpty(Producto.Foto))
        {
            <img src="@Producto.Foto" alt="Foto de @Producto.Name" class="img-thumbnail" style="max-width: 150px;" />
        }
    </div>
</div>

@code {
    [Parameter]
    public ProductoDTO Producto { get; set; }

    [Parameter]
    public EventCallback OnDeleted { get; set; }

    private void Editar()
    {
        NavigationManager.NavigateTo($"/FormProducto/{Producto.Id}");
    }

    private async Task Borrar()
    {
        var response = await Http.DeleteAsync($"Producto/{Producto.Id}");
        if (response.IsSuccessStatusCode && OnDeleted.HasDelegate)
        {
            await OnDeleted.InvokeAsync();
        }
    }
}
